angular.module("ks.scrollRepeat",[]).directive("scrollRepeat",function(t){"use strict";var e=50,r=50,i=200,l=function(t){if(t.match(/limitTo/)||t.match(/startFrom/))throw new Error('"limitTo" and "startFrom" filters are not allowed in scroll-repeat directive')},s=function(t){var e=$(window).height(),r=t.offset().top-$(window).scrollTop()+t.height();return r-e},o=function(o,n){var a=n.scrollRepeat,c=a.match(/^\s*(.+)\s+in\s+(.*?)\s*(\s+track\s+by\s+(.+)\s*)?$/),u=c[2],p=n.initSize?Number(n.initSize):e,m=n.step?Number(n.step):r,f=n.tolerance?Number(n.tolerance):i;return l(a),o.removeAttr("scroll-repeat"),o.attr("ng-repeat",n.scrollRepeat+" | limitTo:visibleResults"),function(e,r){var i;e.visibleResults=p,t(r)(e),e.$watch(u,function(t){i=t.length},!0);var l=$(r[0]).parent();$(window).on("scroll",function(){var t=s(l);f>=t&&i>e.visibleResults&&safeApply(e,function(){e.visibleResults+=m})})}};return{replace:!1,terminal:!0,priority:2e3,restrict:"A",compile:o}});